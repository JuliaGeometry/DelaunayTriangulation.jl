<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Power Diagrams · DelaunayTriangulation.jl</title><meta name="title" content="Power Diagrams · DelaunayTriangulation.jl"/><meta property="og:title" content="Power Diagrams · DelaunayTriangulation.jl"/><meta property="twitter:title" content="Power Diagrams · DelaunayTriangulation.jl"/><meta name="description" content="Documentation for DelaunayTriangulation.jl."/><meta property="og:description" content="Documentation for DelaunayTriangulation.jl."/><meta property="twitter:description" content="Documentation for DelaunayTriangulation.jl."/><meta property="og:url" content="https://JuliaGeometry.github.io/DelaunayTriangulation.jl/math/power/"/><meta property="twitter:url" content="https://JuliaGeometry.github.io/DelaunayTriangulation.jl/math/power/"/><link rel="canonical" href="https://JuliaGeometry.github.io/DelaunayTriangulation.jl/math/power/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DelaunayTriangulation.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/overview/">Overview</a></li><li><a class="tocitem" href="../../tutorials/unconstrained/">Unconstrained Triangulations</a></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Constrained Triangulations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/constrained_edges/">Constrained Edges</a></li><li><a class="tocitem" href="../../tutorials/constrained_outer_boundary/">Outer Boundary</a></li><li><a class="tocitem" href="../../tutorials/constrained_outer_boundary_segmented/">Segmented Outer Boundary</a></li><li><a class="tocitem" href="../../tutorials/constrained_multiply_connected/">Domain with Interior Holes</a></li><li><a class="tocitem" href="../../tutorials/constrained_interior_within_interiors/">Domain with Interior Holes inside Interior Holes</a></li><li><a class="tocitem" href="../../tutorials/constrained_multipolygon/">Disjoint Domains</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox"/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">Triangulation Operations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/operations_vertex_insertion_deletion/">Vertex Insertion and Deletion</a></li><li><a class="tocitem" href="../../tutorials/operations_segment_insertion/">Edge Insertion</a></li><li><a class="tocitem" href="../../tutorials/operations_ghost_triangles/">Adding or Clearing Ghost Triangles</a></li><li><a class="tocitem" href="../../tutorials/operations_flip_edge/">Edge Flipping</a></li><li><a class="tocitem" href="../../tutorials/operations_legalise_edge/">Legalising an Edge</a></li><li><a class="tocitem" href="../../tutorials/operations_split_edge/">Edge Splitting</a></li><li><a class="tocitem" href="../../tutorials/operations_split_triangle/">Triangle Splitting</a></li><li><a class="tocitem" href="../../tutorials/operations_convex_hull_locking/">Locking and Unlocking the Convex Hull</a></li></ul></li><li><a class="tocitem" href="../../tutorials/refinement/">Mesh Refinement</a></li><li><a class="tocitem" href="../../tutorials/lattice/">Triangulating Rectangular Regions</a></li><li><a class="tocitem" href="../../tutorials/convex/">Triangulating Convex Polygons</a></li><li><a class="tocitem" href="../../tutorials/curve_bounded/">Triangulating Curve-Bounded Domains</a></li><li><a class="tocitem" href="../../tutorials/weighted/">Weighted Triangulations</a></li><li><a class="tocitem" href="../../tutorials/voronoi/">Voronoi Tessellations</a></li><li><input class="collapse-toggle" id="menuitem-2-11" type="checkbox"/><label class="tocitem" for="menuitem-2-11"><span class="docs-label">Clipped Voronoi Tessellations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/clipped/">Clipping to the Convex Hull</a></li><li><a class="tocitem" href="../../tutorials/clipped_rectangle/">Clipping to a Rectangle</a></li><li><a class="tocitem" href="../../tutorials/clipped_polygon/">Clipping to a Generic Convex Polygon</a></li></ul></li><li><a class="tocitem" href="../../tutorials/centroidal/">Centroidal Voronoi Tessellations</a></li><li><a class="tocitem" href="../../tutorials/power/">Power Diagrams</a></li><li><a class="tocitem" href="../../tutorials/point_location/">Point Location</a></li><li><a class="tocitem" href="../../tutorials/nearest/">Nearest Neighbour Queries</a></li><li><a class="tocitem" href="../../tutorials/convex_hull/">Convex Hulls</a></li><li><a class="tocitem" href="../../tutorials/pole_of_inaccessibility/">Pole of Inaccessibility</a></li><li><a class="tocitem" href="../../tutorials/point_in_polygon/">Point-in-Polygon Testing</a></li><li><a class="tocitem" href="../../tutorials/custom_primitive/">Using Custom Structs for Primitives and Boundaries</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Manual</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../manual/overview/">Overview</a></li><li><a class="tocitem" href="../../manual/primitives/">Representing Primitives</a></li><li><a class="tocitem" href="../../manual/boundaries/">Representing Boundaries</a></li><li><a class="tocitem" href="../../manual/ghost_triangles/">Ghost (Negative) Vertices</a></li><li><a class="tocitem" href="../../manual/curve_bounded/">Defining Curve-Bounded Domains</a></li><li><a class="tocitem" href="../../manual/predicates/">Geometrical Predicates</a></li><li><a class="tocitem" href="../../manual/triangulation_output/">Triangulation Output</a></li><li><a class="tocitem" href="../../manual/voronoi_output/">Voronoi Tessellation Output</a></li><li><a class="tocitem" href="../../manual/predicate_kernels/">Predicate Kernels</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">API Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/overview/">Section Overview</a></li><li><a class="tocitem" href="../../api/data_structures/">Data Structures</a></li><li><a class="tocitem" href="../../api/triangulation/">Triangulations</a></li><li><a class="tocitem" href="../../api/operations/">Triangulation Operations</a></li><li><a class="tocitem" href="../../api/voronoi/">Voronoi Tessellations</a></li><li><a class="tocitem" href="../../api/convex_hull/">Convex Hull</a></li><li><a class="tocitem" href="../../api/curves/">Curves</a></li><li><a class="tocitem" href="../../api/iterators/">Iterators</a></li><li><a class="tocitem" href="../../api/point_location/">Point Location</a></li><li><a class="tocitem" href="../../api/predicates/">Predicates</a></li><li><a class="tocitem" href="../../api/statistics/">Triangulation Statistics</a></li><li><a class="tocitem" href="../../api/primitives/">Primitive Interfaces</a></li><li><a class="tocitem" href="../../api/other/">Other</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Extended Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../extended/overview/">Overview</a></li><li><a class="tocitem" href="../../extended/data_structures/">Data Structures</a></li><li><a class="tocitem" href="../../extended/algorithms/">Algorithm Internals</a></li><li><a class="tocitem" href="../../extended/utils/">Utility Functions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox" checked/><label class="tocitem" for="menuitem-6"><span class="docs-label">Mathematical Details</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../overview/">Overview</a></li><li><a class="tocitem" href="../delaunay/">Delaunay Triangulations</a></li><li><a class="tocitem" href="../constrained/">Constrained Delaunay Triangulations</a></li><li><a class="tocitem" href="../convex/">Triangulating Convex Polygons</a></li><li><a class="tocitem" href="../refinement/">Mesh Refinement</a></li><li><a class="tocitem" href="../curves/">Curves</a></li><li><a class="tocitem" href="../curve_bounded/">Triangulating Curve-Bounded Domains</a></li><li><a class="tocitem" href="../weighted/">Weighted Delaunay Triangulations</a></li><li><a class="tocitem" href="../voronoi/">Voronoi Tessellations</a></li><li><a class="tocitem" href="../clipped/">Clipped Voronoi Tessellations</a></li><li><a class="tocitem" href="../centroidal/">Centroidal Voronoi Tessellations</a></li><li class="is-active"><a class="tocitem" href>Power Diagrams</a><ul class="internal"><li><a class="tocitem" href="#Orthoballs-and-Orthocenters:-Generalising-Circumcircles"><span>Orthoballs and Orthocenters: Generalising Circumcircles</span></a></li><li><a class="tocitem" href="#Computing-the-Power-Diagram"><span>Computing the Power Diagram</span></a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Example Applications</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../applications/overview/">Overview</a></li><li><a class="tocitem" href="../../applications/interpolation/">Interpolation</a></li><li><a class="tocitem" href="../../applications/cell_simulations/">Cellular Biology</a></li><li><a class="tocitem" href="../../applications/pde_discretisation/">Solving PDEs</a></li></ul></li><li><a class="tocitem" href="../../terminology/">Terminology</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Mathematical Details</a></li><li class="is-active"><a href>Power Diagrams</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Power Diagrams</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaGeometry/DelaunayTriangulation.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaGeometry/DelaunayTriangulation.jl/blob/main/docs/src/math/power.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Power-Diagrams"><a class="docs-heading-anchor" href="#Power-Diagrams">Power Diagrams</a><a id="Power-Diagrams-1"></a><a class="docs-heading-anchor-permalink" href="#Power-Diagrams" title="Permalink"></a></h1><p>Now we discuss power diagrams, the dual of a weighted Delaunay triangulation. The main difference between a power diagram and a Voronoi tessellation is that the power diagram is defined using a <em>power distance</em> instead of a <em>Euclidean distance</em>. Recall that weighted Delaunay triangulations are derived from a point set <span>$\mathcal P$</span> and an associated set of weights <span>$\mathcal W$</span> so that each point <span>$p_i$</span> has an associated weight <span>$w_i$</span>. If we let <span>$p[w]$</span> denote a point <span>$p$</span> with weight <span>$w$</span>, then the power distance between two points <span>$p$</span> and <span>$q$</span> is defined by</p><p class="math-container">\[\pi(p[w_p], q[w_p]) = d(p, q)^2 - w_p - w_q,\]</p><p>where <span>$d(p, q)$</span> is the Euclidean distance between <span>$p$</span> and <span>$q$</span>. This notation is also used for unweighted points, which are assigned a weight of <span>$0$</span>.</p><p>We can use this power distance to define a power diagram. For a given site <span>$u$</span>, its <em>power cell</em> is </p><p class="math-container">\[W_u = \{p \in \mathbb R^2 : \forall q \in \mathcal P^+, \pi(p, u[w_u]) \leq \pi(p, q[w_q])\},\]</p><p>where <span>$\mathcal P^+$</span> is the set of points <span>$\mathcal P$</span> with the assigned weights from <span>$\mathcal W$</span>. In particular, <span>$W_u$</span> is the set of all points closer to <span>$u$</span> than to any other point in <span>$\mathcal P$</span>, where the distance is measured using the power distance.</p><h2 id="Orthoballs-and-Orthocenters:-Generalising-Circumcircles"><a class="docs-heading-anchor" href="#Orthoballs-and-Orthocenters:-Generalising-Circumcircles">Orthoballs and Orthocenters: Generalising Circumcircles</a><a id="Orthoballs-and-Orthocenters:-Generalising-Circumcircles-1"></a><a class="docs-heading-anchor-permalink" href="#Orthoballs-and-Orthocenters:-Generalising-Circumcircles" title="Permalink"></a></h2><p>Recall that Voronoi tessellations are computed by simply connecting the circumcenters of the Delaunay triangles. For power diagrams, we need a generalisation of the circumcenter. Remember that the circumcenter can be derived by intersecting the perpendicular bisectors of a triangle&#39;s edges. A similar definition can be used for obtaining what is called the <em>orthocenter</em>.</p><p>To start, we need a geometric interpretion of a weighted point. We can relate it to the notion of a <a href="https://en.wikipedia.org/wiki/Power_of_a_point">power of a point</a>. Define the ball <span>$B_p = \{x \in \mathbb R^2: d(p, x) \leq \sqrt{w_p}\}$</span>, and note that the squared length of the line segment extending from a point <span>$x$</span> to touch <span>$B_p$</span> tangentially is given by <span>$d(x, p)^2 - w_p$</span> (see the first equation on the linked Wikipedia page).  This distance is exactly <span>$\pi(x, p[w_p])$</span>. Thus:</p><ul><li>If <span>$x \notin B_p$</span>, then <span>$\pi(x, p[w_p]) &gt; 0$</span>.</li><li>If <span>$x$</span> is exactly on the boundary of <span>$B_p$</span>, then <span>$\pi(x, p[w_p]) = 0$</span>.</li><li>If <span>$x \in B_p$</span>, then <span>$\pi(x, p[w_p]) &lt; 0$</span>.</li></ul><p>Note that, since weights may be negative, <span>$\sqrt{w_p}$</span> may be complex, in which case every point lies outside <span>$B_p$</span>. Thus, our geometric interpretation of a weighted point is exactly as the ball <span>$B_p$</span>.</p><p>We can use this interpretation to understand how the generators of the power diagram are related to the vertices of the power cells. Remember that the definition of a power cell implies that a vertex <span>$v$</span> of the diagram if equidistant in power distance from the weighted generators that generate it, e.g. if <span>$v$</span> neighbours generators <span>$u$</span> and <span>$w$</span>, then <span>$\pi(v, u[w_u]) = \pi(v, w[w_w])$</span>. Let this constant power distance be <span>$\omega_v$</span>. Then, the power distance from <span>$v$</span> to its weighted generators is </p><p class="math-container">\[\pi(v[\omega_v], u[w_u]) = d(v, u)^2 - \omega_v - w_u,\]</p><p>but we also know <span>$\pi(v, u[w_u]) = \omega_v = d(v, u)^2 - w_u$</span>. Thus,</p><p class="math-container">\[\pi(v[\omega_v], u[w_u]) = 0.\]</p><p>We say that <span>$v[\omega_v]$</span> is <em>orthogonal</em> to <span>$u[w_u]$</span>. With this definition, <span>$v[\omega_v]$</span> is <em>orthogonal</em> to all of its generators. Letting <span>$B_v$</span> be the ball centered at <span>$v$</span> with radius <span>$\sqrt{\omega_v}$</span> (which could be complex), we call <span>$B_v$</span> the <em>orthoball</em> centered at <span>$v$</span>. More generally, we say that two weighted points are</p><ol><li><em>Orthogonal</em> if the power distance between them is zero;</li><li><em>Farther than orthogonal</em> if the power distance between them is positive;</li><li><em>Closer than orthogonal</em> if the power distance between them is negative.</li></ol><p>The orthoball can be used to generalise circumcircles. The <em>orthoball</em> of a triangle is defined to be the ball that is orthogonal to all three vertices of the triangle. In particular, if <span>$c$</span> if the ball&#39;s center, called the <em>orthocenter</em>, and <span>$\sqrt{\omega_c}$</span> is its radius, called the <em>orthoradius</em>, then <span>$d(v, c)^2 - w_v - \omega_c = 0$</span> for each vertex <span>$v$</span> of the triangle. The center and radius can be computed by solving this system of equations <span>$\{d(v, c)^2 - w_v - \omega_c = 0\}$</span>. It is possible to show these orthoballs are exactly what we need to define duality between the power diagram and the weighted Delaunay triangulation. </p><h2 id="Computing-the-Power-Diagram"><a class="docs-heading-anchor" href="#Computing-the-Power-Diagram">Computing the Power Diagram</a><a id="Computing-the-Power-Diagram-1"></a><a class="docs-heading-anchor-permalink" href="#Computing-the-Power-Diagram" title="Permalink"></a></h2><p>The above discussion leads us to a method for computing the power diagram. Just as a Voronoi tessellation can be computed by joining up the circumcenters, simply join up the orthocenters of each triangle. Special care may be needed to accommodate the fact that not all generator&#39;s power cells are non-empty.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../centroidal/">« Centroidal Voronoi Tessellations</a><a class="docs-footer-nextpage" href="../../applications/overview/">Overview »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Sunday 8 September 2024 20:48">Sunday 8 September 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
